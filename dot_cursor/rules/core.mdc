---
name: 'Core Rules'
tag: CORE
description: 'Always-applied safety, style, and tool usage rules'
alwaysApply: true
---

# Core Rules

These rules apply to EVERY interaction. They are non-negotiable.

## ask_question Tool (STRICT)

**Use `ask_question` for ANY question with discrete options:**

| Situation | Use ask_question |
|-----------|------------------|
| Scope narrowing | "Which file should I focus on?" |
| Implementation choice | "Use approach A, B, or C?" |
| Yes/No confirmation | "Should I proceed with X?" |
| Configuration selection | "Which config option?" |
| Plan alternatives | "Modify plan or execute?" |
| Error resolution | "Fix with option A or B?" |

**NEVER list options A/B/C in prose** - use the tool instead.

**Plain text is OK for:**
- Open-ended clarification (no discrete options)
- Follow-up within conversation flow
- Reporting results (information, not decision)

## Safety (Single Source of Truth)

| Never | Why | Instead |
|-------|-----|---------|
| `git push` | User controls remote | Ask permission, wait |
| `git push --force` | Rewrites history | Never without explicit permission |
| `git commit` (unprompted) | User decides when | Wait for explicit request |
| `rm` anything | Data loss risk | `mv` to backup location |
| `scancel -u $USER` | Kills ALL jobs | Cancel specific job IDs only |
| `sed` for file edits | Error-prone, no diff | Cursor's file tools |
| `sleep` in commands | Wastes time, can hang | Just wait for user |
| Unbounded scans | Hangs forever | Use `head`, scoped paths |
| try/catch blocks | Hides errors | Let errors propagate (fail fast) |
| Deep nesting (>4 levels) | Unreadable | Extract to functions |

**Quick mental check:** Push? Commit? Delete? Slurm? Slow command? â†’ Stop and verify.

## Before ANY Action

1. Check for `CLAUDE.md` in repo root - read current context
2. Check `.specstory/history/` for recent session context
3. Understand existing code patterns before writing

## Response Style

- Be concise and direct
- Show commands before running
- Max 4 indentation levels
- Match existing repo patterns

## Always End With a Question

Every response should end with a follow-up question to maintain momentum.

| Situation | Example |
|-----------|---------|
| After completing task | "Should I commit this, or is there more to do?" |
| After showing status | "What needs attention first?" |
| Unclear request | "Could you clarify what you'd like me to focus on?" |

**Default:** "What would you like to do next?"
