---
name: 'Source Code'
tag: DIR-SRC
description: 'Production source code - robust, maintainable'
globs: ["**/src/**/*", "**/lib/**/*", "**/pkg/**/*"]
alwaysApply: false
---

# Production Source Code Guidelines

Rules for production source directories. Inherits from `always.md` and `etiquette.md`.

## Core Principles

1. **Robust** - Handle edge cases at boundaries
2. **Maintainable** - Clear abstractions, good naming
3. **Testable** - Design for dependency injection
4. **Documented** - Docstrings for public interfaces

## Error Handling

Handle errors at system boundaries, not internally:

```python
# Good: Handle at API boundary
def api_endpoint(request):
    try:
        data = parse_request(request)
        return success_response(process(data))
    except ValidationError as e:
        return error_response(400, str(e))

# Good: Internal logic fails fast
def process(data):
    return transform(validate(data))  # No try/catch
```

## Code Quality

- Type hints for function signatures
- Docstrings for public functions/classes
- No magic numbers (use constants)
- Max 4 indentation levels

## Design Patterns

- SOLID principles where appropriate
- Composition over inheritance
- Explicit over implicit
- Simple over clever

## Before Writing

1. Check for `CLAUDE.md` - read current context
2. Understand existing patterns in the codebase
3. Consider edge cases upfront
4. Design interface first, then implement

## Never Do

- Break existing APIs without discussion
- Add dependencies without justification
- Over-engineer simple solutions
- Skip type hints on public interfaces
